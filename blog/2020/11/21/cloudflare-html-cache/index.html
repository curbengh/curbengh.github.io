<!DOCTYPE html><html lang="en-GB"><head><meta charset="utf-8"><title>Cloudflare does not cache html by default | Ming Di Leom&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://mdleom.com/blog/2020/11/21/cloudflare-html-cache/"><meta name="description" content="But it can be easily enabled"><meta property="article:author" content="Ming Di Leom"><meta property="article:tag" content="cloudflare"><meta property="og:type" content="article"><meta property="og:title" content="Cloudflare does not cache html by default"><meta property="og:url" content="https://mdleom.com/blog/2020/11/21/cloudflare-html-cache/"><meta property="og:site_name" content="Ming Di Leom&#39;s Blog"><meta property="og:description" content="But it can be easily enabled"><meta property="og:locale" content="en_GB"><meta property="og:image" content="https://mdleom.com/screenshot/blog/2020/11/21/cloudflare-html-cache/"><meta property="article:published_time" content="2020-11-21T00:00:00.000Z"><link rel="alternate" href="/atom.xml" title="Ming Di Leom's Blog" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/svg/favicon.svg" type="image/svg+xml" sizes="any"><link rel="apple-touch-icon" href="/apple-touch-icon-180x180.png"><link rel="manifest" href="/site.webmanifest"><link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"><link rel="stylesheet" href="/css/chameleon.css"><meta name="yandex-verification" content="e026a03a5dd06730"><meta name="generator" content="Hexo 7.1.1"></head><body><div id="container" class="container"><article id="post-cloudflare-html-cache" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><header id="header" class="header"><nav class="main-nav"><a class="main-nav-link" href="/">Home</a> <a class="main-nav-link" href="/blog/">Blog</a> <a class="main-nav-link" href="/about/">About</a> <a class="main-nav-link" href="/atom.xml">Feed</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a><div class="search-container"><form id="searchForm" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click"><img src="/svg/search.svg"></a></form></div></nav><nav class="mobile-nav"><a class="site-title" href="/">mdleom.com</a><ul class="mobile-nav-menu"><label for="mobile-menu-toggle"><a class="no-underline" id="menu-button">&#9776;</a></label> <input id="mobile-menu-toggle" type="checkbox"><ul id="mobile-nav-link"><div class="search-container"><form id="searchFormMob" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click-mobile"><img src="/svg/search.svg"></a></form></div><i>Powered by DuckDuckGo</i> <a class="mobile-nav-link-a" href="/">Home</a> <a class="mobile-nav-link-a" href="/blog/">Blog</a> <a class="mobile-nav-link-a" href="/about/">About</a> <a class="mobile-nav-link-a" href="/atom.xml">Feed</a> <a class="mobile-nav-link-a" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a></ul></ul></nav></header><hr class="header-hr"><div class="article-inner"><header class="article-header"><h1 class="p-name entry-title article-title" itemprop="headline name">Cloudflare does not cache html by default <a id="btnshare"><img src="/svg/share.svg"></a></h1></header><p class="p-summary">But it can be easily enabled</p><div class="e-content article-entry" itemprop="articleBody"><p>In this guide, I’ll show you how to enable html caching. Since I started using Cloudflare eight months ago, I always make sure <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control" rel="noopener external nofollow noreferrer">caching</a> is configured correctly so that most of the content are served from CDN, which is much faster than serving content from my origin server. This is in addition to the fact that this website is a static site, so <em>all</em> content are cacheable. I configured caching in <a href="https://gitlab.com/curben/blog/-/blob/master/source/_headers" rel="noopener external nofollow noreferrer">Netlify</a>, <a href="/blog/2020/03/14/caddy-nixos-part-3/#Cache-Control">Caddy</a> and <a href="https://support.cloudflare.com/hc/en-us/articles/200168276-Understanding-Browser-Cache-TTL" rel="noopener external nofollow noreferrer">Cloudflare</a>. However, every time I check the analytics (Analytics → Performance), it only showed 1% of content is served from cache.</p><p><a href="/img/20201121/cf-before.png"><img srcset="/img/20201121/cf-before.png?f=auto&width=320 320w,/img/20201121/cf-before.png?f=auto&width=468 468w,/img/20201121/cf-before.png?f=auto&width=768 768w,/img/20201121/cf-before.png?f=auto 800w" sizes="(max-width: 320px) 320px,(max-width: 468px) 468px,(max-width: 768px) 768px,800px" src="/img/20201121/cf-before.png?f=auto" title="1% bandwidth saved" alt="1% bandwidth saved" loading="lazy"></a></p><p>It was only last week that I realised that Cloudflare does not cache everything by default, only certain <a href="https://support.cloudflare.com/hc/en-us/articles/200172516#h_a01982d4-d5b6-4744-bb9b-a71da62c160a" rel="noopener external nofollow noreferrer">file extensions</a> are cached and they do not include HTML and XML, despite majority (55%) of content served are HTML and XML.</p><p>Html caching can be easily enabled through Page Rules. Since my site’s content are all static, I opt to cache <em>everything</em> instead. To achieve this, I created a new page rule:</p><ul><li>URL: <code>https://mdleom.com/*</code><ul><li>The asterisk (*) is to apply the page rule to every page under HTTPS, instead of just the homepage.</li></ul></li><li>Setting: Cache Level</li><li>Value: Cache Everything</li></ul><p>After a week with the new page rule, cached content has now increased to 72%.</p><p><a href="/img/20201121/cf-after.png"><img srcset="/img/20201121/cf-after.png?f=auto&width=320 320w,/img/20201121/cf-after.png?f=auto&width=468 468w,/img/20201121/cf-after.png?f=auto&width=768 768w,/img/20201121/cf-after.png?f=auto 800w" sizes="(max-width: 320px) 320px,(max-width: 468px) 468px,(max-width: 768px) 768px,800px" src="/img/20201121/cf-after.png?f=auto" title="72% bandwidth saved" alt="72% bandwidth saved" loading="lazy"></a></p></div><footer class="article-footer"><ul class="article-meta"><li><span class="label">Published Date:</span> <time class="dt-published" datetime="2020-11-21T00:00:00.000Z" itemprop="datePublished">21 <a href="/blog/2020/11/" title="See November 2020's posts">Nov</a> <a href="/blog/2020/" title="See 2020's posts">2020</a></time></li><li><span class="label">Tag:</span><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cloudflare/" rel="tag">Cloudflare</a></li></ul></li><li><span class="label">Source:</span> <a href="https://gitlab.com/curben/blog/-/blob/master/source/_posts/cloudflare-html-cache.md" rel="noopener external nofollow noreferrer">cloudflare-html-cache.md</a></li><hr></ul></footer></div><nav id="article-nav" class="article-nav"><span class="article-nav-link-wrap newer"><strong>Newer</strong> <a href="/blog/2020/11/22/cloudflare-hsts/"><div class="article-nav-title">Enabling HSTS preload in Cloudflare</div></a></span><span class="article-nav-link-wrap older"><strong>Older</strong> <a href="/blog/2020/11/12/caddy2-pre-compressed/"><div class="article-nav-title">Serving pre-compressed files in Caddy 2</div></a></span></nav></article></div><footer id="footer" class="post-footer footer"><hr><div id="copyright" class="copyright">&copy; 2018-2024 Ming Di Leom. <a href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">Powered by </a><a href="https://hexo.io/" rel="noopener external nofollow noreferrer">Hexo</a> with <a href="https://gitlab.com/curben/blog/tree/master/themes/chameleon" rel="noopener external nofollow noreferrer">Chameleon</a> theme.<br>Content is available under <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="noopener external nofollow noreferrer license" itemprop="license">CC-BY-SA 4.0</a>, unless indicated otherwise.<br><a class="main-nav-link" href="/disclaimer/">Disclaimer</a> <a class="main-nav-link" href="https://stats.uptimerobot.com/1394zup2LQ" rel="noopener external nofollow noreferrer">Status</a> <a class="main-nav-link" href="https://xw226dvxac7jzcpsf4xb64r4epr6o5hgn46dxlqk7gnjptakik6xnzqd.onion/" rel="noopener external nofollow noreferrer">Onion</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog#mirrors" rel="noopener external nofollow noreferrer">Eepsite</a></div></footer><script src="/libs/clipboard-2.0.6.min.js" defer></script><script src="/js/copy-button.js"></script><script src="/js/chameleon.js"></script></body></html>