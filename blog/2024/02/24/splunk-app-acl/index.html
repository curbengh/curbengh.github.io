<!DOCTYPE html><html lang="en-GB"><head><meta charset="utf-8"><title>Applying default-deny ACL in Splunk app | Ming Di Leom&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://mdleom.com/blog/2024/02/24/splunk-app-acl/"><meta name="description" content="Isolate access between roles"><meta property="article:author" content="Ming Di Leom"><meta property="article:tag" content="splunk"><meta property="og:type" content="article"><meta property="og:title" content="Applying default-deny ACL in Splunk app"><meta property="og:url" content="https://mdleom.com/blog/2024/02/24/splunk-app-acl/"><meta property="og:site_name" content="Ming Di Leom&#39;s Blog"><meta property="og:description" content="Isolate access between roles"><meta property="og:locale" content="en_GB"><meta property="og:image" content="https://mdleom.com/screenshot/blog/2024/02/24/splunk-app-acl/"><meta property="article:published_time" content="2024-02-24T00:00:00.000Z"><link rel="alternate" href="/atom.xml" title="Ming Di Leom's Blog" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/svg/favicon.svg" type="image/svg+xml" sizes="any"><link rel="apple-touch-icon" href="/apple-touch-icon-180x180.png"><link rel="manifest" href="/site.webmanifest"><link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"><link rel="stylesheet" href="/css/chameleon.css"><meta name="yandex-verification" content="e026a03a5dd06730"><meta name="generator" content="Hexo 7.1.1"></head><body><div id="container" class="container"><article id="post-splunk-app-acl" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><header id="header" class="header"><nav class="main-nav"><a class="main-nav-link" href="/">Home</a> <a class="main-nav-link" href="/blog/">Blog</a> <a class="main-nav-link" href="/about/">About</a> <a class="main-nav-link" href="/atom.xml">Feed</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a><div class="search-container"><form id="searchForm" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click"><img src="/svg/search.svg"></a></form></div></nav><nav class="mobile-nav"><a class="site-title" href="/">mdleom.com</a><ul class="mobile-nav-menu"><label for="mobile-menu-toggle"><a class="no-underline" id="menu-button">&#9776;</a></label> <input id="mobile-menu-toggle" type="checkbox"><ul id="mobile-nav-link"><div class="search-container"><form id="searchFormMob" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click-mobile"><img src="/svg/search.svg"></a></form></div><i>Powered by DuckDuckGo</i> <a class="mobile-nav-link-a" href="/">Home</a> <a class="mobile-nav-link-a" href="/blog/">Blog</a> <a class="mobile-nav-link-a" href="/about/">About</a> <a class="mobile-nav-link-a" href="/atom.xml">Feed</a> <a class="mobile-nav-link-a" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a></ul></ul></nav></header><hr class="header-hr"><div class="article-inner"><header class="article-header"><h1 class="p-name entry-title article-title" itemprop="headline name">Applying default-deny ACL in Splunk app <a id="btnshare"><img src="/svg/share.svg"></a></h1></header><p class="p-summary">Isolate access between roles</p><div class="e-content article-entry" itemprop="articleBody"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Default-deny-ACL"><span class="toc-text">Default-deny ACL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Non-removable-lookup-file"><span class="toc-text">Non-removable lookup file</span></a></li></ol><p>When I first started creating custom Splunk app, I had an incorrect understanding of access control list (ACLs) configured using <a href="https://docs.splunk.com/Documentation/Splunk/latest/Admin/Defaultmetaconf" rel="noopener external nofollow noreferrer">default.meta.conf</a> (located at app_folder&#x2F;metadata&#x2F;default.meta) whereby I could grant read access to a role like this:</p><pre><code class="hljs conf">[]
access = read : [ roleA ], write : [ ]

[lookups/lookupB.csv]
access = read : [ roleA, roleB ], write : [ ]</code><button class="copy-button">Copy</button></pre><p>Or like this:</p><pre><code class="hljs conf">[]
access = read : [ roleA ], write : [ ]

[lookups]
access = read : [ roleA, roleB ], write : [ ]</code><button class="copy-button">Copy</button></pre><p>None of the above configs will grant roleB read access to lookupB.csv. For the rest of this discussion, we assume that roleB should have access to lookupB.csv only.</p><pre><code class="hljs md"><span class="hljs-section"># Interaction of ACLs across app-level, category level, and specific object configuration:</span>

<span class="hljs-bullet">-</span> To access/use an object, users must have read access to:
<span class="hljs-bullet">  -</span> the app containing the object
<span class="hljs-bullet">  -</span> the generic category within the app (for example, [views])
<span class="hljs-bullet">  -</span> the object itself
<span class="hljs-bullet">-</span> If any layer does not permit read access, the object will not be accessible.</code><button class="copy-button">Copy</button></pre><blockquote><p>For brevity, this article will only discuss about read access which has slightly different interaction of ACLs compared to write access. Don’t worry, once you understood read access, it’s much easier to understand write access.</p></blockquote><p>Notice a role must at least have read access to the app. The simplest way to grant roleB read access is,</p><pre><code class="hljs conf">[]
access = read : [ roleA, roleB ], write : [ ]</code><button class="copy-button">Copy</button></pre><p>While the above config is effective, but it does not meet the access requirement: roleB is granted read access to every objects in that app.</p><p>roleB can be restricted as such:</p><pre><code class="hljs conf">[]
access = read : [ roleA, roleB ], write : [ ]

[lookups/lookupA.csv]
access = read : [ roleA ], write : [ ]

[lookups/lookupB.csv]
access = read : [ roleA, roleB ], write : [ ]

[lookups/lookupC.csv]
access = read : [ roleA ], write : [ ]</code><button class="copy-button">Copy</button></pre><p>It is effective and meets the requirement, but there is an issue. Every new lookup&#x2F;object will now need to specify <code>access = read : [ roleA ], write : [ ]</code> to restrict roleB’s access. This is similar to a default-allow firewall.</p><h2 id="Default-deny-ACL">Default-deny ACL <a href="#Default-deny-ACL" class="headerlink" title="Default-deny ACL">§</a></h2><p>How to implement default-deny ACL? We can achieve it by separating into two apps: appA is accessible to roleA only, appB is accessible to roleA and roleB. Any object we want to share with roleA and roleB, we put it in appB instead.</p><pre><div class="caption"><span>appA</span></div><code class="hljs conf">[]
access = read : [ roleA ], write : [ ]</code><button class="copy-button">Copy</button></pre><pre><div class="caption"><span>appB</span></div><code class="hljs conf">[]
access = read : [ roleA, roleB ], write : [ ]</code><button class="copy-button">Copy</button></pre><p>In this approach, every new objects created in appA will not be accessible to roleB because it does not have app access.</p><h2 id="Non-removable-lookup-file">Non-removable lookup file <a href="#Non-removable-lookup-file" class="headerlink" title="Non-removable lookup file">§</a></h2><p>I noticed lookup files that have object-level ACL, e.g.</p><pre><code class="hljs conf">[lookups/lookupC.csv]
access = read : [ roleA ], write : [ ]</code><button class="copy-button">Copy</button></pre><p>makes it non-removable, even with admin&#x2F;sc-admin role.</p><p>My theory is that the object is non-removable to prevent the ACL from being orphaned. But this theory does not hold, at least for a lookup file that is shipped with an app; deleting a lookup file merely resets its content back to the app’s version. Deleting a lookup file is necessary during an app update that also have updated content of a bundled lookup file. Even when a lookup was never modified, Splunk will keep the content during an app update. Updating an app does not automatically update the bundled lookup, the lookup will only be updated after a delete operation.</p><p>Similar limitation (i.e. app update does not update the app’s object) also applies to dashboards. However, there is no way to delete a dashboard xml in Splunk Cloud, so updating a dashboard through app update always require app uninstallation beforehand.</p></div><footer class="article-footer"><ul class="article-meta"><li><span class="label">Published Date:</span> <time class="dt-published" datetime="2024-02-24T00:00:00.000Z" itemprop="datePublished">24 <a href="/blog/2024/02/" title="See February 2024's posts">Feb</a> <a href="/blog/2024/" title="See 2024's posts">2024</a></time></li><li><span class="label">Tag:</span><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/splunk/" rel="tag">Splunk</a></li></ul></li><li><span class="label">Source:</span> <a href="https://gitlab.com/curben/blog/-/blob/master/source/_posts/splunk-app-acl.md" rel="noopener external nofollow noreferrer">splunk-app-acl.md</a></li><hr></ul></footer></div><nav id="article-nav" class="article-nav"><span class="article-nav-link-wrap newer"></span> <span class="article-nav-link-wrap older"><strong>Older</strong> <a href="/blog/2023/10/01/splunk-ldapsearch-useraccountcontrol/"><div class="article-nav-title">Query LOCKOUT and PASSWORD_EXPIRED flags on Splunk SA-ldapsearch</div></a></span></nav></article></div><footer id="footer" class="post-footer footer"><hr><div id="copyright" class="copyright">&copy; 2018-2024 Ming Di Leom. <a href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">Powered by </a><a href="https://hexo.io/" rel="noopener external nofollow noreferrer">Hexo</a> with <a href="https://gitlab.com/curben/blog/tree/master/themes/chameleon" rel="noopener external nofollow noreferrer">Chameleon</a> theme.<br>Content is available under <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="noopener external nofollow noreferrer license" itemprop="license">CC-BY-SA 4.0</a>, unless indicated otherwise.<br><a class="main-nav-link" href="/disclaimer/">Disclaimer</a> <a class="main-nav-link" href="https://stats.uptimerobot.com/1394zup2LQ" rel="noopener external nofollow noreferrer">Status</a> <a class="main-nav-link" href="https://xw226dvxac7jzcpsf4xb64r4epr6o5hgn46dxlqk7gnjptakik6xnzqd.onion/" rel="noopener external nofollow noreferrer">Onion</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog#mirrors" rel="noopener external nofollow noreferrer">Eepsite</a></div></footer><script src="/libs/clipboard-2.0.6.min.js" defer></script><script src="/js/copy-button.js"></script><script src="/js/chameleon.js"></script></body></html>