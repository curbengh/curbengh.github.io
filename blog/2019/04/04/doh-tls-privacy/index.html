<!DOCTYPE html><html lang="en-GB"><head><meta charset="utf-8"><title>DNS-over-TLS/DNS-over-HTTPS does not protect your privacy | Ming Di Leom&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://mdleom.com/blog/2019/04/04/doh-tls-privacy/"><meta name="description" content="DoT&#x2F;DoH does not completely eliminate ISP surveillance."><meta property="article:author" content="Ming Di Leom"><meta property="article:tag" content="security"><meta property="article:tag" content="privacy"><meta property="article:tag" content="doh"><meta property="og:type" content="article"><meta property="og:title" content="DNS-over-TLS&#x2F;DNS-over-HTTPS does not protect your privacy"><meta property="og:url" content="https://mdleom.com/blog/2019/04/04/doh-tls-privacy/"><meta property="og:site_name" content="Ming Di Leom&#39;s Blog"><meta property="og:description" content="DoT&#x2F;DoH does not completely eliminate ISP surveillance."><meta property="og:locale" content="en_GB"><meta property="og:image" content="https://mdleom.com/screenshot/blog/2019/04/04/doh-tls-privacy/"><meta property="article:published_time" content="2019-04-04T00:00:00.000Z"><link rel="alternate" href="/atom.xml" title="Ming Di Leom's Blog" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/svg/favicon.svg" type="image/svg+xml" sizes="any"><link rel="apple-touch-icon" href="/apple-touch-icon-180x180.png"><link rel="manifest" href="/site.webmanifest"><link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"><link rel="stylesheet" href="/css/chameleon.css"><meta name="yandex-verification" content="e026a03a5dd06730"><meta name="generator" content="Hexo 7.1.1"></head><body><div id="container" class="container"><article id="post-doh-tls-privacy" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><header id="header" class="header"><nav class="main-nav"><a class="main-nav-link" href="/">Home</a> <a class="main-nav-link" href="/blog/">Blog</a> <a class="main-nav-link" href="/about/">About</a> <a class="main-nav-link" href="/atom.xml">Feed</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a><div class="search-container"><form id="searchForm" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click"><img src="/svg/search.svg"></a></form></div></nav><nav class="mobile-nav"><a class="site-title" href="/">mdleom.com</a><ul class="mobile-nav-menu"><label for="mobile-menu-toggle"><a class="no-underline" id="menu-button">&#9776;</a></label> <input id="mobile-menu-toggle" type="checkbox"><ul id="mobile-nav-link"><div class="search-container"><form id="searchFormMob" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click-mobile"><img src="/svg/search.svg"></a></form></div><i>Powered by DuckDuckGo</i> <a class="mobile-nav-link-a" href="/">Home</a> <a class="mobile-nav-link-a" href="/blog/">Blog</a> <a class="mobile-nav-link-a" href="/about/">About</a> <a class="mobile-nav-link-a" href="/atom.xml">Feed</a> <a class="mobile-nav-link-a" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a></ul></ul></nav></header><hr class="header-hr"><div class="article-inner"><header class="article-header"><h1 class="p-name entry-title article-title" itemprop="headline name">DNS-over-TLS/DNS-over-HTTPS does not protect your privacy <a id="btnshare"><img src="/svg/share.svg"></a></h1></header><p class="p-summary">DoT/DoH does not completely eliminate ISP surveillance.</p><div class="e-content article-entry" itemprop="articleBody"><p>Recently I stumbled upon this <a href="https://lists.zx2c4.com/pipermail/wireguard/2019-February/003902.html" rel="noopener external nofollow noreferrer">bug report</a>, and as a side note, the reporter wants to use DNS-over-TLS (DoT) for privacy reasons; to prevent the ISP from knowing visited website. It turns out many also believe this after a brief search for news articles on DoT or DNS-over-HTTPS (DoH). Actually, DoT&#x2F;DoH does not completely eliminate ISP surveillance.</p><p>ISP still knows what <strong>IP address</strong> you are connecting to. Even with HTTPS and DoT&#x2F;DoH, ISP currently can sniff the website domain you are visiting&#x2F;visited including the complete URL due to a security weakness in the <a href="https://en.wikipedia.org/wiki/Server_Name_Indication" rel="noopener external nofollow noreferrer">Server Name Indication</a>. This weakness can be fixed by using <a href="https://blog.cloudflare.com/esni/" rel="noopener external nofollow noreferrer">Encrypted SNI</a> (ESNI).</p><p>But even with all that, I repeat, ISP still <em>knows</em> what IP address you are connecting to. A simple reverse DNS lookup or even just by visiting the IP address can reveal what website it belongs to. While reverse DNS lookup is not as easy as ten years ago due to the current proliferation of content delivery network (CDN) like Cloudflare, yet it is still possible. For example, A <code>dig startpage @9.9.9.9</code> returned <code>216.218.239.2</code>. When you go to the IP through a web browser, it redirects to startpage.com. Going to gitlab.com’s IP resulted in SSL warning with gitlab.com shown as the valid hostname.</p><p><a href="/img/20190404/gitlab-ip.png"><img srcset="/img/20190404/gitlab-ip.png?f=auto&width=320 320w,/img/20190404/gitlab-ip.png?f=auto&width=468 468w,/img/20190404/gitlab-ip.png?f=auto&width=768 768w,/img/20190404/gitlab-ip.png?f=auto 800w" sizes="(max-width: 320px) 320px,(max-width: 468px) 468px,(max-width: 768px) 768px,800px" src="/img/20190404/gitlab-ip.png?f=auto" title="Reverse domain lookup through browser" alt="Reverse domain lookup through browser" loading="lazy"></a></p><p>Websites that are behind CDN can be harder to lookup. For example, <code>dig is.gd @9.9.9.9</code> returned <code>104.25.23.21</code>, but going to that IP resulted in an error page. Even then, with sufficient dataset, it is still <a href="https://blog.apnic.net/2019/08/23/what-can-you-learn-from-an-ip-address/" rel="noopener external nofollow noreferrer">possible</a> to infer a website from an IP.</p><p>Anyhow, DoT&#x2F;DoH helps to address DNS spoofing issue by preventing the DNS query&#x2F;answer from being maliciously modified. It makes it <em>harder</em> for the ISP from recording your browsing history because it prevents them from doing DNS logging. But they can still continue doing <strong>IP logging</strong>. Not to mention DoT&#x2F;DoH resolvers also can log DNS traffic. Even <a href="https://en.wikipedia.org/wiki/DNSCrypt" rel="noopener external nofollow noreferrer">DNSCrypt</a> cannot prevent that.</p><p>A brief search on DoT&#x2F;DoH topics showed many (most?) news articles perpetuate the misconception that it can prevents ISP surveillance.</p><table><thead><tr><th>Title</th><th>Link</th></tr></thead><tbody><tr><td>How to keep your ISP’s nose out of your browser history with encrypted DNS</td><td><a href="https://arstechnica.com/information-technology/2018/04/how-to-keep-your-isps-nose-out-of-your-browser-history-with-encrypted-dns/" rel="noopener external nofollow noreferrer">[1]</a></td></tr><tr><td>Android takes aim at ISP surveillance with DNS privacy</td><td><a href="https://nakedsecurity.sophos.com/2017/10/27/android-takes-aim-at-isp-surveillance-with-dns-privacy/" rel="noopener external nofollow noreferrer">[2]</a></td></tr><tr><td>Android To Get ‘DNS over TLS’ Support To Hide Your Browsing Data From ISPs</td><td><a href="https://wccftech.com/android-dns-over-tls-isp/" rel="noopener external nofollow noreferrer">[3]</a></td></tr><tr><td>New Android Future “DNS over TLS” going to Stop ISPs from Knowing what websites you visit</td><td><a href="https://gbhackers.com/dns-over-tls/" rel="noopener external nofollow noreferrer">[4]</a></td></tr><tr><td>Prevent ISPs from seeing what website you’re viewing with DNS over TLS</td><td><a href="https://www.thesslstore.com/blog/what-is-dns-over-tls/" rel="noopener external nofollow noreferrer">[5]</a></td></tr><tr><td>Android getting “DNS over TLS” support to stop ISPs from knowing what websites you visit</td><td><a href="https://www.xda-developers.com/android-dns-over-tls-website-privacy/" rel="noopener external nofollow noreferrer">[6]</a></td></tr></tbody></table><p><em><strong>TL;DR</strong></em> DoT&#x2F;DoH doesn’t hide your destination IPs. Use Tor&#x2F;VPN for that.</p></div><footer class="article-footer"><ul class="article-meta"><li><span class="label">Published Date:</span> <time class="dt-published" datetime="2019-04-04T00:00:00.000Z" itemprop="datePublished">4 <a href="/blog/2019/04/" title="See April 2019's posts">Apr</a> <a href="/blog/2019/" title="See 2019's posts">2019</a></time></li><li><span class="label">Tag:</span><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/doh/" rel="tag">Doh</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/privacy/" rel="tag">Privacy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/security/" rel="tag">Security</a></li></ul></li><li><span class="label">Source:</span> <a href="https://gitlab.com/curben/blog/-/blob/master/source/_posts/doh-tls-privacy.md" rel="noopener external nofollow noreferrer">doh-tls-privacy.md</a></li><hr></ul></footer></div><nav id="article-nav" class="article-nav"><span class="article-nav-link-wrap newer"><strong>Newer</strong> <a href="/blog/2019/04/07/firefox-instances-profiles/"><div class="article-nav-title">How to run more than one Firefox instance</div></a></span><span class="article-nav-link-wrap older"><strong>Older</strong> <a href="/blog/2019/02/28/aliexpress-no-login-firefox/"><div class="article-nav-title">Firefox, Cross-Origin and AliExpress</div></a></span></nav></article></div><footer id="footer" class="post-footer footer"><hr><div id="copyright" class="copyright">&copy; 2018-2024 Ming Di Leom. <a href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">Powered by </a><a href="https://hexo.io/" rel="noopener external nofollow noreferrer">Hexo</a> with <a href="https://gitlab.com/curben/blog/tree/master/themes/chameleon" rel="noopener external nofollow noreferrer">Chameleon</a> theme.<br>Content is available under <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="noopener external nofollow noreferrer license" itemprop="license">CC-BY-SA 4.0</a>, unless indicated otherwise.<br><a class="main-nav-link" href="/disclaimer/">Disclaimer</a> <a class="main-nav-link" href="https://stats.uptimerobot.com/1394zup2LQ" rel="noopener external nofollow noreferrer">Status</a> <a class="main-nav-link" href="https://xw226dvxac7jzcpsf4xb64r4epr6o5hgn46dxlqk7gnjptakik6xnzqd.onion/" rel="noopener external nofollow noreferrer">Onion</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog#mirrors" rel="noopener external nofollow noreferrer">Eepsite</a></div></footer><script src="/libs/clipboard-2.0.6.min.js" defer></script><script src="/js/copy-button.js"></script><script src="/js/chameleon.js"></script></body></html>