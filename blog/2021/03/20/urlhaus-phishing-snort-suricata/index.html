<!DOCTYPE html><html lang="en-GB"><head><meta charset="utf-8"><title>urlhaus-filter and phishing-filter available as Snort and Suricata rules | Ming Di Leom&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://mdleom.com/blog/2021/03/20/urlhaus-phishing-snort-suricata/"><meta name="description" content="Tested on Snort 2, Snort 3 and Suricata 6"><meta property="article:author" content="Ming Di Leom"><meta property="article:tag" content="security"><meta property="og:type" content="article"><meta property="og:title" content="urlhaus-filter and phishing-filter available as Snort and Suricata rules"><meta property="og:url" content="https://mdleom.com/blog/2021/03/20/urlhaus-phishing-snort-suricata/"><meta property="og:site_name" content="Ming Di Leom&#39;s Blog"><meta property="og:description" content="Tested on Snort 2, Snort 3 and Suricata 6"><meta property="og:locale" content="en_GB"><meta property="og:image" content="https://mdleom.com/screenshot/blog/2021/03/20/urlhaus-phishing-snort-suricata/"><meta property="article:published_time" content="2021-03-20T00:00:00.000Z"><meta property="article:modified_time" content="2021-04-05T00:00:00.000Z"><link rel="alternate" href="/atom.xml" title="Ming Di Leom's Blog" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/svg/favicon.svg" type="image/svg+xml" sizes="any"><link rel="apple-touch-icon" href="/apple-touch-icon-180x180.png"><link rel="manifest" href="/site.webmanifest"><link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"><link rel="stylesheet" href="/css/chameleon.css"><meta name="yandex-verification" content="e026a03a5dd06730"><meta name="generator" content="Hexo 7.1.1"></head><body><div id="container" class="container"><article id="post-urlhaus-phishing-snort-suricata" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><header id="header" class="header"><nav class="main-nav"><a class="main-nav-link" href="/">Home</a> <a class="main-nav-link" href="/blog/">Blog</a> <a class="main-nav-link" href="/about/">About</a> <a class="main-nav-link" href="/atom.xml">Feed</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a><div class="search-container"><form id="searchForm" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click"><img src="/svg/search.svg"></a></form></div></nav><nav class="mobile-nav"><a class="site-title" href="/">mdleom.com</a><ul class="mobile-nav-menu"><label for="mobile-menu-toggle"><a class="no-underline" id="menu-button">&#9776;</a></label> <input id="mobile-menu-toggle" type="checkbox"><ul id="mobile-nav-link"><div class="search-container"><form id="searchFormMob" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click-mobile"><img src="/svg/search.svg"></a></form></div><i>Powered by DuckDuckGo</i> <a class="mobile-nav-link-a" href="/">Home</a> <a class="mobile-nav-link-a" href="/blog/">Blog</a> <a class="mobile-nav-link-a" href="/about/">About</a> <a class="mobile-nav-link-a" href="/atom.xml">Feed</a> <a class="mobile-nav-link-a" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a></ul></ul></nav></header><hr class="header-hr"><div class="article-inner"><header class="article-header"><h1 class="p-name entry-title article-title" itemprop="headline name">urlhaus-filter and phishing-filter available as Snort and Suricata rules <a id="btnshare"><img src="/svg/share.svg"></a></h1></header><p class="p-summary">Tested on Snort 2, Snort 3 and Suricata 6</p><div class="e-content article-entry" itemprop="articleBody"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#urlhaus-filter"><span class="toc-text">urlhaus-filter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Snort2"><span class="toc-text">Snort2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Snort3"><span class="toc-text">Snort3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Suricata"><span class="toc-text">Suricata</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#phishing-filter"><span class="toc-text">phishing-filter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Snort2-1"><span class="toc-text">Snort2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Snort3-1"><span class="toc-text">Snort3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Suricata-1"><span class="toc-text">Suricata</span></a></li></ol></li></ol><blockquote><p>Update (5 April 2021): The blocklists are also available in <a href="https://dnsrpz.info/" rel="noopener external nofollow noreferrer">Response Policy Zone</a> format.</p></blockquote><p><a href="https://gitlab.com/curben/urlhaus-filter" rel="noopener external nofollow noreferrer">urlhaus-filter</a> and <a href="https://gitlab.com/curben/phishing-filter" rel="noopener external nofollow noreferrer">phishing-filter</a> are blocklists that target malware and phishing websites respectively. The blocklists are available in many formats:</p><ul><li>uBlock Origin (urlhaus-filter is bundled by default)</li><li>Pi-hole</li><li>AdGuard Home</li><li>AdGuard (browser extension)</li><li>Vivaldi 3.3+</li><li>Hosts file</li><li>Dnsmasq</li><li>BIND</li><li>Unbound</li><li>IE9+</li></ul><p>In addition to the above formats&#x2F;software, they are now also available as <a href="https://www.snort.org/" rel="noopener external nofollow noreferrer">Snort</a> and <a href="https://suricata-ids.org/" rel="noopener external nofollow noreferrer">Suricata</a> IDS rulesets. Both Snort 2 and 3 are supported; a vast majority of Linux distribution have not support v3 yet and there are no official v3 binaries. Note that Snort 2 ruleset is not compatible with Snort 3 and vice versa.</p><p>I planned to create these IDS rulesets for a long time, but held it off because upstream <a href="https://urlhaus.abuse.ch/" rel="noopener external nofollow noreferrer">URLhaus</a> already support them and there was no user request. I finally decided to go for it after the product announcement of <a href="https://aws.amazon.com/blogs/aws/aws-network-firewall-new-managed-firewall-service-in-vpc/" rel="noopener external nofollow noreferrer">AWS Firewall</a> with its support of custom Suricata ruleset, plus incomplete support of URLhaus on Snort 2 ruleset.</p><p>Installation guide as follow.</p><h2 id="urlhaus-filter">urlhaus-filter <a href="#urlhaus-filter" class="headerlink" title="urlhaus-filter">§</a></h2><h3 id="Snort2">Snort2 <a href="#Snort2" class="headerlink" title="Snort2">§</a></h3><pre><code class="hljs plaintext"># Download ruleset
curl -L &quot;https://curben.gitlab.io/malware-filter/urlhaus-filter-snort2-online.rules&quot; -o &quot;/etc/snort/rules/urlhaus-filter-snort2-online.rules&quot;

# Create a new cron job for daily update
printf &#x27;#!/bin/sh\ncurl -L &quot;https://curben.gitlab.io/malware-filter/urlhaus-filter-snort2-online.rules&quot; -o &quot;/etc/snort/rules/urlhaus-filter-snort2-online.rules&quot;\n&#x27; &gt; /etc/cron.daily/urlhaus-filter

# cron job requires execution permission
chmod 755 /etc/cron.daily/urlhaus-filter

# Configure Snort to use the ruleset
printf &quot;\ninclude \$RULE_PATH/urlhaus-filter-snort2-online.rules\n&quot; &gt;&gt; /etc/snort/snort.conf</code><button class="copy-button">Copy</button></pre><h3 id="Snort3">Snort3 <a href="#Snort3" class="headerlink" title="Snort3">§</a></h3><pre><code class="hljs plaintext"># Download ruleset
curl -L &quot;https://curben.gitlab.io/malware-filter/urlhaus-filter-snort3-online.rules&quot; -o &quot;/etc/snort/rules/urlhaus-filter-snort3-online.rules&quot;

# Create a new cron job for daily update
printf &#x27;#!/bin/sh\ncurl -L &quot;https://curben.gitlab.io/malware-filter/urlhaus-filter-snort3-online.rules&quot; -o &quot;/etc/snort/rules/urlhaus-filter-snort3-online.rules&quot;\n&#x27; &gt; /etc/cron.daily/urlhaus-filter

# cron job requires execution permission
chmod 755 /etc/cron.daily/urlhaus-filter</code><button class="copy-button">Copy</button></pre><p>Configure Snort to use the ruleset:</p><pre><div class="caption"><span>/etc/snort/snort.lua</span></div><code class="hljs diff">ips =
&#123;
  variables = default_variables,
<span class="hljs-addition">+  include = &#x27;rules/urlhaus-filter-snort3-online.rules&#x27;</span>
&#125;</code><button class="copy-button">Copy</button></pre><h3 id="Suricata">Suricata <a href="#Suricata" class="headerlink" title="Suricata">§</a></h3><pre><code class="hljs plaintext"># Download ruleset
curl -L &quot;https://curben.gitlab.io/malware-filter/urlhaus-filter-suricata-online.rules&quot; -o &quot;/etc/suricata/rules/urlhaus-filter-suricata-online.rules&quot;

# Create a new cron job for daily update
printf &#x27;#!/bin/sh\ncurl -L &quot;https://curben.gitlab.io/malware-filter/urlhaus-filter-suricata-online.rules&quot; -o &quot;/etc/suricata/rules/urlhaus-filter-suricata-online.rules&quot;\n&#x27; &gt; /etc/cron.daily/urlhaus-filter

# cron job requires execution permission
chmod 755 /etc/cron.daily/urlhaus-filter</code><button class="copy-button">Copy</button></pre><p>Configure Suricata to use the ruleset:</p><pre><div class="caption"><span>/etc/suricata/suricata.yaml</span></div><code class="hljs diff">rule-files:
  - local.rules
<span class="hljs-addition">+  - urlhaus-filter-suricata-online.rules</span></code><button class="copy-button">Copy</button></pre><h2 id="phishing-filter">phishing-filter <a href="#phishing-filter" class="headerlink" title="phishing-filter">§</a></h2><h3 id="Snort2-1">Snort2 <a href="#Snort2-1" class="headerlink" title="Snort2">§</a></h3><pre><code class="hljs plaintext"># Download ruleset
curl -L &quot;https://curben.gitlab.io/phishing-filter-mirror/phishing-filter-snort2.rules&quot; -o &quot;/etc/snort/rules/phishing-filter-snort2.rules&quot;

# Create a new cron job for daily update
printf &#x27;#!/bin/sh\ncurl -L &quot;https://curben.gitlab.io/phishing-filter-mirror/phishing-filter-snort2.rules&quot; -o &quot;/etc/snort/rules/phishing-filter-snort2.rules&quot;\n&#x27; &gt; /etc/cron.daily/phishing-filter

# cron job requires execution permission
chmod 755 /etc/cron.daily/phishing-filter

# Configure Snort to use the ruleset
printf &quot;\ninclude \$RULE_PATH/phishing-filter-snort2.rules\n&quot; &gt;&gt; /etc/snort/snort.conf</code><button class="copy-button">Copy</button></pre><h3 id="Snort3-1">Snort3 <a href="#Snort3-1" class="headerlink" title="Snort3">§</a></h3><pre><code class="hljs plaintext"># Download ruleset
curl -L &quot;https://curben.gitlab.io/phishing-filter-mirror/phishing-filter-snort3.rules&quot; -o &quot;/etc/snort/rules/phishing-filter-snort3.rules&quot;

# Create a new cron job for daily update
printf &#x27;#!/bin/sh\ncurl -L &quot;https://curben.gitlab.io/phishing-filter-mirror/phishing-filter-snort3.rules&quot; -o &quot;/etc/snort/rules/phishing-filter-snort3.rules&quot;\n&#x27; &gt; /etc/cron.daily/phishing-filter

# cron job requires execution permission
chmod 755 /etc/cron.daily/phishing-filter</code><button class="copy-button">Copy</button></pre><p>Configure Snort to use the ruleset:</p><pre><div class="caption"><span>/etc/snort/snort.lua</span></div><code class="hljs diff">ips =
&#123;
  variables = default_variables,
<span class="hljs-addition">+  include = &#x27;rules/phishing-filter-snort3-online.rules&#x27;</span>
&#125;</code><button class="copy-button">Copy</button></pre><h3 id="Suricata-1">Suricata <a href="#Suricata-1" class="headerlink" title="Suricata">§</a></h3><pre><code class="hljs plaintext"># Download ruleset
curl -L &quot;https://curben.gitlab.io/phishing-filter-mirror/phishing-filter-suricata.rules&quot; -o &quot;/etc/suricata/rules/phishing-filter-suricata.rules&quot;

# Create a new cron job for daily update
printf &#x27;#!/bin/sh\ncurl -L &quot;https://curben.gitlab.io/phishing-filter-mirror/phishing-filter-suricata.rules&quot; -o &quot;/etc/suricata/rules/phishing-filter-suricata.rules&quot;\n&#x27; &gt; /etc/cron.daily/phishing-filter

# cron job requires execution permission
chmod 755 /etc/cron.daily/phishing-filter</code><button class="copy-button">Copy</button></pre><p>Configure Suricata to use the ruleset:</p><pre><div class="caption"><span>/etc/suricata/suricata.yaml</span></div><code class="hljs diff">rule-files:
  - local.rules
<span class="hljs-addition">+  - phishing-filter-suricata.rules</span></code><button class="copy-button">Copy</button></pre></div><footer class="article-footer"><ul class="article-meta"><li><span class="label">Last Updated:</span> <time class="dt-updated" datetime="2021-04-05T00:00:00.000Z" itemprop="dateModified">5 Apr 2021</time></li><li><span class="label">Published Date:</span> <time class="dt-published" datetime="2021-03-20T00:00:00.000Z" itemprop="datePublished">20 <a href="/blog/2021/03/" title="See March 2021's posts">Mar</a> <a href="/blog/2021/" title="See 2021's posts">2021</a></time></li><li><span class="label">Tag:</span><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/security/" rel="tag">Security</a></li></ul></li><li><span class="label">Source:</span> <a href="https://gitlab.com/curben/blog/-/blob/master/source/_posts/urlhaus-phishing-snort-suricata.md" rel="noopener external nofollow noreferrer">urlhaus-phishing-snort-suricata.md</a></li><hr></ul></footer></div><nav id="article-nav" class="article-nav"><span class="article-nav-link-wrap newer"><strong>Newer</strong> <a href="/blog/2021/04/20/python-venv/"><div class="article-nav-title">Separate Python libraries with venv</div></a></span><span class="article-nav-link-wrap older"><strong>Older</strong> <a href="/blog/2021/03/15/rsync-setup-nixos/"><div class="article-nav-title">rsync is surprisingly simple to setup</div></a></span></nav></article></div><footer id="footer" class="post-footer footer"><hr><div id="copyright" class="copyright">&copy; 2018-2024 Ming Di Leom. <a href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">Powered by </a><a href="https://hexo.io/" rel="noopener external nofollow noreferrer">Hexo</a> with <a href="https://gitlab.com/curben/blog/tree/master/themes/chameleon" rel="noopener external nofollow noreferrer">Chameleon</a> theme.<br>Content is available under <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="noopener external nofollow noreferrer license" itemprop="license">CC-BY-SA 4.0</a>, unless indicated otherwise.<br><a class="main-nav-link" href="/disclaimer/">Disclaimer</a> <a class="main-nav-link" href="https://stats.uptimerobot.com/1394zup2LQ" rel="noopener external nofollow noreferrer">Status</a> <a class="main-nav-link" href="https://xw226dvxac7jzcpsf4xb64r4epr6o5hgn46dxlqk7gnjptakik6xnzqd.onion/" rel="noopener external nofollow noreferrer">Onion</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog#mirrors" rel="noopener external nofollow noreferrer">Eepsite</a></div></footer><script src="/libs/clipboard-2.0.6.min.js" defer></script><script src="/js/copy-button.js"></script><script src="/js/chameleon.js"></script></body></html>