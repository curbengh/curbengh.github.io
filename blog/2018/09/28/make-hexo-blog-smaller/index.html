<!DOCTYPE html><html lang="en-GB"><head><meta charset="utf-8"><title>Make Hexo blog smaller | Ming Di Leom&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://mdleom.com/blog/2018/09/28/make-hexo-blog-smaller/"><meta name="description" content="Static site serves html, css, javascript and images. These files can be compressed to reduce bandwidth and speed up the website."><meta property="article:author" content="Ming Di Leom"><meta property="article:tag" content="hexo"><meta property="og:type" content="article"><meta property="og:title" content="Make Hexo blog smaller"><meta property="og:url" content="https://mdleom.com/blog/2018/09/28/make-hexo-blog-smaller/"><meta property="og:site_name" content="Ming Di Leom&#39;s Blog"><meta property="og:description" content="Static site serves html, css, javascript and images. These files can be compressed to reduce bandwidth and speed up the website."><meta property="og:locale" content="en_GB"><meta property="og:image" content="https://mdleom.com/screenshot/blog/2018/09/28/make-hexo-blog-smaller/"><meta property="article:published_time" content="2018-09-28T00:00:00.000Z"><meta property="article:modified_time" content="2018-10-06T00:00:00.000Z"><link rel="alternate" href="/atom.xml" title="Ming Di Leom's Blog" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/svg/favicon.svg" type="image/svg+xml" sizes="any"><link rel="apple-touch-icon" href="/apple-touch-icon-180x180.png"><link rel="manifest" href="/site.webmanifest"><link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"><link rel="stylesheet" href="/css/chameleon.css"><meta name="yandex-verification" content="e026a03a5dd06730"><meta name="generator" content="Hexo 7.1.1"></head><body><div id="container" class="container"><article id="post-make-hexo-blog-smaller" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><header id="header" class="header"><nav class="main-nav"><a class="main-nav-link" href="/">Home</a> <a class="main-nav-link" href="/blog/">Blog</a> <a class="main-nav-link" href="/about/">About</a> <a class="main-nav-link" href="/atom.xml">Feed</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a><div class="search-container"><form id="searchForm" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click"><img src="/svg/search.svg"></a></form></div></nav><nav class="mobile-nav"><a class="site-title" href="/">mdleom.com</a><ul class="mobile-nav-menu"><label for="mobile-menu-toggle"><a class="no-underline" id="menu-button">&#9776;</a></label> <input id="mobile-menu-toggle" type="checkbox"><ul id="mobile-nav-link"><div class="search-container"><form id="searchFormMob" method="post" action="https://duckduckgo.com/" rel="noopener external nofollow noreferrer" role="search"><input type="search" name="q" class="search-box" placeholder="Search..." title="Powered by DuckDuckGo" enterkeyhint="search"> <input type="hidden" name="sites" value="mdleom.com"> <input type="hidden" name="kd" value="-1"> <input type="hidden" name="kg" value="p"> <input type="hidden" name="kae" value="#000"> <a class="search-button" id="search-click-mobile"><img src="/svg/search.svg"></a></form></div><i>Powered by DuckDuckGo</i> <a class="mobile-nav-link-a" href="/">Home</a> <a class="mobile-nav-link-a" href="/blog/">Blog</a> <a class="mobile-nav-link-a" href="/about/">About</a> <a class="mobile-nav-link-a" href="/atom.xml">Feed</a> <a class="mobile-nav-link-a" href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">GitLab</a></ul></ul></nav></header><hr class="header-hr"><div class="article-inner"><header class="article-header"><h1 class="p-name entry-title article-title" itemprop="headline name">Make Hexo blog smaller <a id="btnshare"><img src="/svg/share.svg"></a></h1></header><p class="p-summary">Static site serves html, css, javascript and images. These files can be compressed to reduce bandwidth and speed up the website.</p><div class="e-content article-entry" itemprop="articleBody"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Minify"><span class="toc-text">Minify</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hexo-all-minifier"><span class="toc-text">hexo-all-minifier</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hexo-yam"><span class="toc-text">hexo-yam</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#Compression"><span class="toc-text">Compression</span></a></li><h1 id="Minify">Minify <a href="#Minify" class="headerlink" title="Minify">§</a></h1><p><a href="https://en.wikipedia.org/wiki/Minification_(programming)" rel="noopener external nofollow noreferrer">Minify</a> html, css, js and svg to remove characters that are not required for the code to function. This process involves removing white space&#x2F;tab, line break and comments. I read somewhere that Google saves gigabytes of bandwidth just by removing line break, which surprised me how much line break alone costs when you have the popularity of Google.com.<br>In Hexo, there are two approaches.</p><h3 id="hexo-all-minifier">hexo-all-minifier <a href="#hexo-all-minifier" class="headerlink" title="hexo-all-minifier">§</a></h3><ol><li>The easiest way is using hexo-all-minifier. Unlike most, this plugin also compress images as well. To use it, simply run the following command in your hexo folder:<pre><code class="hljs bash">$ npm install hexo-all-minifier --save</code><button class="copy-button">Copy</button></pre></li><li>If there is any error during installation, run <code>$ sudo apt install libpng-dev</code> and <code>node node_modules/optipng-bin/lib/install.js</code>.</li><li>Above command will add hexo-all-minifer to your <code>package.json</code> and install it.</li><li>To enable it, put <code>all_minifier: true</code> line at <code>_config.yml</code>.</li><li>Deploy.</li></ol><p>To see this in action, check out this <a href="https://gitlab.com/curben/blog/-/jobs/101703188" rel="noopener external nofollow noreferrer">job log</a>. As you can see, the resulting files are around 20% smaller. However, do note that its image compression dependencies have some <a href="https://snyk.io/test/npm/hexo-all-minifier" rel="noopener external nofollow noreferrer">vulnerabilities</a>. This can be patched using <a href="https://snyk.io/" rel="noopener external nofollow noreferrer">Snyk</a>.</p><h3 id="hexo-yam">hexo-yam <a href="#hexo-yam" class="headerlink" title="hexo-yam">§</a></h3><p>Despite the convenience of hexo-all-minifier, I don’t use it due to potential vulnerability. I don’t need its image compression since the image hosting I’m currently using, <a href="https://cloudinary.com/" rel="noopener external nofollow noreferrer">Cloudinary</a>, offers <a href="https://cloudinary.com/documentation/responsive_images#responsive_images_with_automatic_quality_selection" rel="noopener external nofollow noreferrer">auto compression</a>.</p><p>So, I switch to a leaner plugin, <a href="https://github.com/curbengh/hexo-yam" rel="noopener external nofollow noreferrer">hexo-yam</a>. To use it, simply run the following command in your hexo folder:</p><pre><code class="hljs bash">$ npm install hexo-yam --save</code><button class="copy-button">Copy</button></pre><p>and deploy.</p><h1 id="Compression">Compression <a href="#Compression" class="headerlink" title="Compression">§</a></h1><p><a href="https://en.wikipedia.org/wiki/Data_compression" rel="noopener external nofollow noreferrer">Compression</a> uses more advanced technique to reduce the file size even further. Most modern web browsers support gzip decompression and prefer it (with appropriate HTTP header). As you might know from zipping a text file, this can yield significant reduction in file size. For example, my home page <code>index.html</code> is less than half smaller (3.3KB &gt; 1.2KB). Check it out <a href="https://gitlab.com/curben/blog/-/jobs/101703188/artifacts/browse/public/" rel="noopener external nofollow noreferrer">here</a>.</p><p><em><strong>Update:</strong></em> hexo-yam 0.5.0+ offers gzip and brotli compressions. After you install it, it will automatically compress assets files to <code>.gz</code> and <code>.br</code> whenever hexo generate&#x2F;deploy&#x2F;server. This means the command <code>$ find ....</code> as shown below is no longer required.</p><ol><li>Linux distro has built-in gzip. Install brotli through apt&#x2F;dnf&#x2F;yum&#x2F;pacman.</li><li>To compress, simply run the following commands after you generate static files (<code>$ hexo generate</code>), only <code>public</code> folder is affected,<pre><code class="hljs bash">$ find public -<span class="hljs-built_in">type</span> f -iregex <span class="hljs-string">&#x27;.*\.\(htm\|html\|txt\|text\|js\|css\)$&#x27;</span> -execdir gzip -f --keep &#123;&#125; \;
$ find public -<span class="hljs-built_in">type</span> f -iregex <span class="hljs-string">&#x27;.*\.\(htm\|html\|txt\|text\|js\|css\)$&#x27;</span> -execdir brotli -f --keep &#123;&#125; \;</code><button class="copy-button">Copy</button></pre></li><li>If you use CI like <code>.gitlab-ci.yml</code> or <code>.travis.yml</code>, simply add the above command under <code>script:</code>, after <code>hexo generate</code>.</li><li>Deploy.</li></ol></div><footer class="article-footer"><ul class="article-meta"><li><span class="label">Last Updated:</span> <time class="dt-updated" datetime="2018-10-06T00:00:00.000Z" itemprop="dateModified">6 Oct 2018</time></li><li><span class="label">Published Date:</span> <time class="dt-published" datetime="2018-09-28T00:00:00.000Z" itemprop="datePublished">28 <a href="/blog/2018/09/" title="See September 2018's posts">Sep</a> <a href="/blog/2018/" title="See 2018's posts">2018</a></time></li><li><span class="label">Tag:</span><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/" rel="tag">Hexo</a></li></ul></li><li><span class="label">Source:</span> <a href="https://gitlab.com/curben/blog/-/blob/master/source/_posts/make-hexo-blog-smaller.md" rel="noopener external nofollow noreferrer">make-hexo-blog-smaller.md</a></li><hr></ul></footer></div><nav id="article-nav" class="article-nav"><span class="article-nav-link-wrap newer"><strong>Newer</strong> <a href="/blog/2018/10/01/secure-node-modules-snyk/"><div class="article-nav-title">Secure node modules with Snyk</div></a></span><span class="article-nav-link-wrap older"><strong>Older</strong> <a href="/blog/2018/09/26/how-to-remove-windows-10-default-apps/"><div class="article-nav-title">How to remove Windows 10 default apps</div></a></span></nav></article></div><footer id="footer" class="post-footer footer"><hr><div id="copyright" class="copyright">&copy; 2018-2024 Ming Di Leom. <a href="https://gitlab.com/curben/blog" rel="noopener external nofollow noreferrer">Powered by </a><a href="https://hexo.io/" rel="noopener external nofollow noreferrer">Hexo</a> with <a href="https://gitlab.com/curben/blog/tree/master/themes/chameleon" rel="noopener external nofollow noreferrer">Chameleon</a> theme.<br>Content is available under <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="noopener external nofollow noreferrer license" itemprop="license">CC-BY-SA 4.0</a>, unless indicated otherwise.<br><a class="main-nav-link" href="/disclaimer/">Disclaimer</a> <a class="main-nav-link" href="https://stats.uptimerobot.com/1394zup2LQ" rel="noopener external nofollow noreferrer">Status</a> <a class="main-nav-link" href="https://xw226dvxac7jzcpsf4xb64r4epr6o5hgn46dxlqk7gnjptakik6xnzqd.onion/" rel="noopener external nofollow noreferrer">Onion</a> <a class="main-nav-link" href="https://gitlab.com/curben/blog#mirrors" rel="noopener external nofollow noreferrer">Eepsite</a></div></footer><script src="/libs/clipboard-2.0.6.min.js" defer></script><script src="/js/copy-button.js"></script><script src="/js/chameleon.js"></script></body></html>